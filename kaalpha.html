<!DOCTYPE html>
<html lang="kn">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>‡≤ï‡≤®‡≥ç‡≤®‡≤° ‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≥Å ‚Äî ‡≤°‡≥ç‡≤∞‡≥ç‡≤Ø‡≤æ‡≤ó‡≥ç & ‡≤°‡≥ç‡≤∞‡≤æ‡≤™‡≥ç (Modern UI)</title>
    <style>
      :root {
        --bg: #0b1020; /* deep ink */
        --surface: #12172b;
        --surface-2: #1a2040;
        --card: #0f1530;
        --muted: #8ea2c6;
        --text: #e6ecff;
        --accent: #6ea8ff;
        --accent-2: #7ef0c1;
        --danger: #ff7a7a;
        --warning: #ffd36e;
        --success: #7ef0c1;
        --border: 1px solid rgba(255, 255, 255, 0.12);
        --radius: 16px;
        --shadow: 0 10px 30px rgba(0, 0, 0, 0.35),
          inset 0 0 0 1px rgba(255, 255, 255, 0.04);
      }
      @media (prefers-color-scheme: light) {
        :root {
          --bg: #f7f9fc;
          --surface: #ffffff;
          --surface-2: #f3f6fb;
          --card: #ffffff;
          --muted: #556581;
          --text: #0d1222;
          --accent: #2b6cf6;
          --accent-2: #0bb88a;
          --danger: #e23e3e;
          --warning: #c98500;
          --success: #079a6a;
          --border: 1px solid rgba(13, 18, 34, 0.08);
          --shadow: 0 10px 30px rgba(13, 18, 34, 0.08);
        }
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Noto Sans Kannada, Noto Sans, Arial, sans-serif;
        background: radial-gradient(
            1200px 800px at 10% 0%,
            rgba(110, 168, 255, 0.15),
            transparent 60%
          ),
          radial-gradient(
            1000px 700px at 110% -10%,
            rgba(126, 240, 193, 0.12),
            transparent 60%
          ),
          var(--bg);
        color: var(--text);
        line-height: 1.6;
      }
      a {
        color: inherit;
      }
      .app {
        max-width: 1100px;
        margin-inline: auto;
        padding: 24px;
      }

      /* Header */
      .header {
        display: flex;
        gap: 16px;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 5;
        padding: 14px 16px;
        margin: -24px -24px 12px;
        background: linear-gradient(
            180deg,
            rgba(0, 0, 0, 0.35),
            rgba(0, 0, 0, 0)
          ),
          var(--surface);
        backdrop-filter: blur(8px);
        border-bottom: var(--border);
      }
      .brand {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .logo {
        width: 38px;
        height: 38px;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--accent), var(--accent-2));
        box-shadow: var(--shadow);
      }
      .title {
        font-weight: 800;
        letter-spacing: 0.3px;
      }
      .subtitle {
        color: var(--muted);
        font-size: 0.95rem;
      }

      /* Controls toolbar */
      .toolbar {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }
      .btn {
        appearance: none;
        border: 0;
        border-radius: 12px;
        padding: 10px 14px;
        background: var(--surface-2);
        color: var(--text);
        cursor: pointer;
        box-shadow: var(--shadow);
        transition: transform 0.08s ease, background 0.2s ease,
          box-shadow 0.2s ease;
        font-weight: 700;
      }
      .btn:hover {
        transform: translateY(-1px);
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn--primary {
        background: linear-gradient(135deg, var(--accent), #8ebaff);
        color: #051028;
      }
      .btn--success {
        background: linear-gradient(135deg, var(--accent-2), #c4ffe9);
        color: #041c17;
      }
      .btn--ghost {
        background: transparent;
        border: var(--border);
      }
      .btn--danger {
        background: linear-gradient(135deg, #ff7a7a, #ffb1b1);
        color: #3d0404;
      }

      /* Info card */
      .card {
        border-radius: var(--radius);
        background: linear-gradient(
            180deg,
            rgba(255, 255, 255, 0.04),
            rgba(255, 255, 255, 0)
          ),
          var(--card);
        box-shadow: var(--shadow);
        border: var(--border);
      }
      .info {
        padding: 14px 16px;
        margin: 12px 0;
        display: grid;
        gap: 10px;
      }
      details summary {
        cursor: pointer;
        list-style: none;
      }
      details summary::-webkit-details-marker {
        display: none;
      }
      details {
        border-radius: 12px;
        border: var(--border);
        padding: 10px 12px;
        background: var(--surface-2);
      }

      /* Grid layout */
      .grid {
        display: grid;
        grid-template-columns: 1.05fr 0.95fr;
        gap: 14px;
        margin-top: 12px;
      }
      @media (max-width: 960px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }

      /* Panels */
      .panel {
        min-height: 420px;
        display: flex;
        flex-direction: column;
      }
      .panel__head {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 14px;
        border-bottom: var(--border);
      }
      .panel__title {
        font-weight: 800;
        letter-spacing: 0.2px;
      }
      .kpi {
        display: flex;
        gap: 10px;
        align-items: center;
        color: var(--muted);
      }
      .chip {
        font-size: 0.85rem;
        border-radius: 999px;
        border: var(--border);
        padding: 6px 10px;
        background: var(--surface-2);
      }

      .panel__body {
        flex: 1;
        overflow: auto;
        padding: 12px;
        display: grid;
        gap: 10px;
      }

      /* Draggable items */
      .draggable,
      .placed-letter {
        user-select: none;
        cursor: grab;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        font-size: 30px;
        font-weight: 800;
        padding: 14px 16px;
        border-radius: 16px;
        background: linear-gradient(
            180deg,
            rgba(255, 255, 255, 0.06),
            rgba(255, 255, 255, 0)
          ),
          var(--surface-2);
        border: var(--border);
        box-shadow: var(--shadow);
        transition: transform 0.12s ease, background 0.2s ease,
          border-color 0.2s ease;
      }
      .draggable:active,
      .placed-letter:active {
        cursor: grabbing;
      }
      .draggable:hover {
        transform: translateY(-2px);
      }
      .dragging {
        transform: scale(1.04) rotate(-1deg) !important;
        background: linear-gradient(
            180deg,
            rgba(126, 240, 193, 0.15),
            rgba(255, 255, 255, 0)
          ),
          var(--surface-2);
      }

      /* Left list specifics */
      .placed-letter {
        justify-content: space-between;
      }
      .index {
        font: 600 12px/1 ui-monospace, SFMono-Regular, Menlo, Consolas,
          monospace;
        color: var(--muted);
        padding: 3px 8px;
        border-radius: 999px;
        border: var(--border);
      }
      .remove-btn {
        font: 700 22px/1 system-ui;
        color: var(--danger);
        cursor: pointer;
        padding: 0 6px;
      }

      /* Right pool layout */
      #right-container .panel__body {
        grid-template-columns: repeat(auto-fill, minmax(88px, 1fr));
        align-content: start;
      }

      /* Empty states */
      .empty {
        opacity: 0.65;
        font-size: 0.95rem;
        color: var(--muted);
        text-align: center;
        padding: 24px;
      }

      /* Footer score */
      .footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 12px;
        gap: 12px;
      }
      .progress {
        flex: 1;
        height: 12px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
        overflow: hidden;
      }
      .progress > span {
        display: block;
        height: 100%;
        background: linear-gradient(90deg, var(--accent), var(--accent-2));
        width: 0%;
      }

      /* Modal */
      .modal {
        position: fixed;
        inset: 0;
        display: none;
        align-items: center;
        justify-content: center;
        background: rgba(0, 0, 0, 0.55);
        backdrop-filter: blur(3px);
        z-index: 20;
      }
      .modal.open {
        display: flex;
      }
      .modal__card {
        max-width: 820px;
        width: min(92vw, 820px);
        background: var(--surface);
        border: var(--border);
        border-radius: 18px;
        box-shadow: var(--shadow);
      }
      .modal__head {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 14px 16px;
        border-bottom: var(--border);
      }
      .modal__body {
        padding: 16px;
      }
      .letters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(64px, 1fr));
        gap: 10px;
      }
      .letter-pill {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
        border-radius: 12px;
        border: var(--border);
        background: var(--surface-2);
        font-size: 28px;
        font-weight: 800;
      }

      /* Toast */
      .toast {
        position: fixed;
        left: 50%;
        transform: translateX(-50%);
        bottom: 18px;
        z-index: 25;
        background: var(--surface);
        border: var(--border);
        padding: 12px 14px;
        border-radius: 12px;
        box-shadow: var(--shadow);
        display: none;
      }
      .toast.show {
        display: block;
      }

      /* Focus */
      :focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
      }

      /* Motion reduce */
      @media (prefers-reduced-motion: reduce) {
        .btn,
        .draggable,
        .placed-letter {
          transition: none;
        }
      }
    </style>
  </head>
  <body>
    <div class="app">
      <header class="header">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div class="title">‡≤ï‡≤®‡≥ç‡≤®‡≤° ‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥ ‡≤Ü‡≤ü</div>
            <div class="subtitle">‡≤é‡≤≥‡≥Ü‡≤¶‡≥Å ‡≤¨‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤ï‡≥ç‡≤∞‡≤Æ‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Ö‡≤≥‡≤µ‡≤°‡≤ø‡≤∏‡≤ø</div>
          </div>
        </div>
        <nav class="toolbar" aria-label="Game controls">
          <button
            class="btn btn--ghost"
            id="shuffleBtn"
            title="‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤Æ‡≤ø‡≤∂‡≥ç‡≤∞‡≤ø‡≤§ ‡≤Æ‡≤æ‡≤°‡≤ø"
          >
            üîÄ ‡≤Æ‡≤ø‡≤∂‡≥ç‡≤∞‡≤ø‡≤§
          </button>
          <button class="btn" id="hintBtn" title="‡≤∏‡≤≤‡≤π‡≥Ü ‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≤ø/‡≤Æ‡≤∞‡≥Ü‡≤Æ‡≤æ‡≤°‡≤ø">
            üí° ‡≤∏‡≤≤‡≤π‡≥Ü
          </button>
          <button class="btn btn--success" id="checkBtn">
            ‚úÖ ‡≤â‡≤§‡≥ç‡≤§‡≤∞ ‡≤™‡≤∞‡≤ø‡≤∂‡≥Ä‡≤≤‡≤ø‡≤∏‡≤ø
          </button>
          <button class="btn" id="showCorrectBtn">üìú ‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤ï‡≥ç‡≤∞‡≤Æ</button>
          <button class="btn btn--danger" id="resetBtn">‚Ü∫ ‡≤Æ‡≤∞‡≥Å‡≤∏‡≥ç‡≤•‡≤æ‡≤™‡≤ø‡≤∏‡≤ø</button>
        </nav>
      </header>

      <section class="card info">
        <details id="helpBox" open>
          <summary><strong>‡≤¨‡≤≥‡≤ï‡≥Ü ‡≤∏‡≥Ç‡≤ö‡≤®‡≥Ü</strong></summary>
          <div>
            ‡≤¨‡≤≤ ‡≤™‡≥ç‡≤Ø‡≤æ‡≤®‡≥Ü‡≤≤‡≥ç‚Äå‡≤®‡≤ø‡≤Ç‡≤¶ ‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤é‡≤° ‡≤™‡≥ç‡≤Ø‡≤æ‡≤®‡≥Ü‡≤≤‡≥ç‚Äå‡≤ó‡≥Ü ‡≤é‡≤≥‡≥Ü‡≤Ø‡≤ø‡≤∞‡≤ø ‡≤Ö‡≤•‡≤µ‡≤æ ‡≤ï‡≥ç‡≤≤‡≤ø‡≤ï‡≥ç
            ‡≤Æ‡≤æ‡≤°‡≤ø. ‡≤é‡≤° ‡≤™‡≥ç‡≤Ø‡≤æ‡≤®‡≥Ü‡≤≤‡≥ç‚Äå‡≤®‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Æ‡≥á‡≤≤‡≥ç‡≤ï‡≤°‡≥Ü/‡≤ï‡≥Ü‡≤≥‡≤ï‡≤°‡≥Ü‡≤ó‡≥Ü ‡≤é‡≤≥‡≥Ü‡≤¶‡≤∞‡≥Ü ‡≤ï‡≥ç‡≤∞‡≤Æ ‡≤¨‡≤¶‡≤≤‡≤æ‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü. √ó
            ‡≤Æ‡≥á‡≤≤‡≥Ü ‡≤ï‡≥ç‡≤≤‡≤ø‡≤ï‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø‡≤¶‡≤∞‡≥Ü ‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤µ‡≥Å ‡≤Æ‡≤∞‡≥Å ‡≤¨‡≤≤‡≤ï‡≥ç‡≤ï‡≥Ü ‡≤π‡≥ã‡≤ó‡≥Å‡≤§‡≥ç‡≤§‡≤¶‡≥Ü.
          </div>
        </details>
        <div class="footer">
          <div class="kpi">
            <span class="chip"
              >‡≤á‡≤ü‡≥ç‡≤ü‡≤¶‡≥ç‡≤¶‡≥Å: <span id="placedCount">0</span>/<span id="totalCount"
                >0</span
              ></span
            ><span class="chip">‡≤Ö‡≤Ç‡≤ï‡≤ó‡≤≥‡≥Å: <span id="score">0</span>%</span>
          </div>
          <div class="progress" aria-hidden="true">
            <span id="progressFill"></span>
          </div>
        </div>
      </section>

      <main class="grid">
        <!-- Left: Place Here -->
        <section class="card panel" id="leftPanel" aria-labelledby="leftTitle">
          <div class="panel__head">
            <h2 id="leftTitle" class="panel__title">‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤á‡≤∞‡≤ø‡≤∏‡≤ø</h2>
            <div class="kpi">
              <span class="chip" id="leftHint">‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤¨‡≤ø‡≤°‡≤ø</span>
            </div>
          </div>
          <div
            id="left-container"
            class="panel__body"
            role="list"
            aria-live="polite"
          >
            <div class="empty" id="leftEmpty">‡≤á‡≤≤‡≥ç‡≤≤‡≤ø ‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤é‡≤≥‡≥Ü‡≤¶‡≥Å ‡≤á‡≤°‡≤ø‚Ä¶</div>
          </div>
        </section>

        <!-- Right: Letters -->
        <section
          class="card panel"
          id="rightPanel"
          aria-labelledby="rightTitle"
        >
          <div class="panel__head">
            <h2 id="rightTitle" class="panel__title">‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≥Å</h2>
            <div class="kpi">
              <span class="chip">‡≤≤‡≤≠‡≥ç‡≤Ø: <span id="availableCount">0</span></span>
            </div>
          </div>
          <div
            id="right-container"
            class="panel__body"
            aria-label="Draggable letters"
          ></div>
        </section>
      </main>

      <!-- Modal: Correct Order -->
      <div class="modal" id="modal">
        <div class="modal__card">
          <div class="modal__head">
            <h3>‡≤∏‡≤∞‡≤ø‡≤Ø‡≤æ‡≤¶ ‡≤ï‡≥ç‡≤∞‡≤Æ</h3>
            <button class="btn btn--ghost" id="closeModal" aria-label="Close">
              ‚úï
            </button>
          </div>
          <div class="modal__body">
            <div class="letters-grid" id="correctGrid"></div>
          </div>
        </div>
      </div>

      <div class="toast" id="toast" role="status" aria-live="polite"></div>
    </div>

    <script>
      // === Data ===
      const KANNADA = [
        "‡≤Ö",
        "‡≤Ü",
        "‡≤á",
        "‡≤à",
        "‡≤â",
        "‡≤ä",
        "‡≤ã",
        "‡≤é",
        "‡≤è",
        "‡≤ê",
        "‡≤í",
        "‡≤ì",
        "‡≤î",
        "‡≤ï",
        "‡≤ñ",
        "‡≤ó",
        "‡≤ò",
        "‡≤ô",
        "‡≤ö",
        "‡≤õ",
        "‡≤ú",
        "‡≤ù",
        "‡≤û",
        "‡≤ü",
        "‡≤†",
        "‡≤°",
        "‡≤¢",
        "‡≤£",
        "‡≤§",
        "‡≤•",
        "‡≤¶",
        "‡≤ß",
        "‡≤®",
        "‡≤™",
        "‡≤´",
        "‡≤¨",
        "‡≤≠",
        "‡≤Æ",
        "‡≤Ø",
        "‡≤∞",
        "‡≤≤",
        "‡≤µ",
        "‡≤∂",
        "‡≤∑",
        "‡≤∏",
        "‡≤π",
        "‡≤≥",
        "‡≤Ö‡≤Ç",
        "‡≤Ö‡≤É",
      ];
      let available = [...KANNADA];
      let placed = [];

      // === DOM ===
      const leftContainer = document.getElementById("left-container");
      const rightContainer = document.getElementById("right-container");
      const placedCount = document.getElementById("placedCount");
      const totalCount = document.getElementById("totalCount");
      const availableCount = document.getElementById("availableCount");
      const progressFill = document.getElementById("progressFill");
      const scoreOut = document.getElementById("score");
      const leftEmpty = document.getElementById("leftEmpty");

      const shuffleBtn = document.getElementById("shuffleBtn");
      const hintBtn = document.getElementById("hintBtn");
      const checkBtn = document.getElementById("checkBtn");
      const resetBtn = document.getElementById("resetBtn");
      const showCorrectBtn = document.getElementById("showCorrectBtn");

      const modal = document.getElementById("modal");
      const correctGrid = document.getElementById("correctGrid");
      const closeModal = document.getElementById("closeModal");
      const toast = document.getElementById("toast");

      // === Utils ===
      const randShuffle = (arr) => [...arr].sort(() => Math.random() - 0.5);
      const showToast = (msg) => {
        toast.textContent = msg;
        toast.classList.add("show");
        setTimeout(() => toast.classList.remove("show"), 2400);
      };
      const updateKPI = () => {
        placedCount.textContent = placed.length;
        totalCount.textContent = KANNADA.length;
        availableCount.textContent = available.length;
        const pct =
          Math.round(
            (placed.filter((l, i) => l === KANNADA[i]).length /
              KANNADA.length) *
              100
          ) || 0;
        scoreOut.textContent = pct;
        progressFill.style.width = `${(placed.length / KANNADA.length) * 100}%`;
        leftEmpty.style.display = placed.length ? "none" : "block";
      };

      // === Renderers ===
      function renderRight() {
        rightContainer.innerHTML = "";
        const list = randShuffle(available);
        if (!list.length) {
          const empty = document.createElement("div");
          empty.className = "empty";
          empty.textContent = "‡≤é‡≤≤‡≥ç‡≤≤‡≤æ ‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≥Å ‡≤¨‡≤≥‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü!";
          rightContainer.appendChild(empty);
          return;
        }
        list.forEach((letter) => {
          const el = document.createElement("div");
          el.className = "draggable";
          el.textContent = letter;
          el.draggable = true;
          el.dataset.letter = letter;
          el.addEventListener("dragstart", dragStart);
          el.addEventListener("dragend", dragEnd);
          el.addEventListener("click", () => moveToLeft(letter));
          rightContainer.appendChild(el);
        });
      }

      function renderLeft() {
        leftContainer.innerHTML = "";
        if (!placed.length) {
          leftContainer.appendChild(leftEmpty);
        }
        placed.forEach((letter, idx) => {
          const row = document.createElement("div");
          row.className = "placed-letter";
          row.draggable = true;
          row.dataset.letter = letter;
          row.innerHTML = `<span class="index">${
            idx + 1
          }</span><span>${letter}</span><span class="remove-btn" title="‡≤§‡≥Ü‡≤ó‡≥Ü‡≤¶‡≥Å‡≤π‡≤æ‡≤ï‡≤ø">√ó</span>`;
          row
            .querySelector(".remove-btn")
            .addEventListener("click", () => removeFromLeft(letter, idx));
          row.addEventListener("dragstart", dragStart);
          row.addEventListener("dragend", dragEnd);
          leftContainer.appendChild(row);
        });
      }

      // === DnD ===
      let dragSource = null;
      function dragStart(e) {
        e.dataTransfer.setData("text/plain", e.target.dataset.letter);
        e.target.classList.add("dragging");
        dragSource =
          e.target.closest("#right-container,#left-container")?.id || null;
      }
      function dragEnd(e) {
        e.target.classList.remove("dragging");
      }

      // Allow drop on left container (append or reorder before/after)
      leftContainer.addEventListener("dragover", (e) => {
        e.preventDefault();
      });
      leftContainer.addEventListener("drop", (e) => {
        e.preventDefault();
        const letter = e.dataTransfer.getData("text/plain");
        const target = e.target.closest(".placed-letter");
        if (dragSource === "right-container") {
          // from pool to placed
          if (!available.includes(letter)) return;
          if (target) {
            const rect = target.getBoundingClientRect();
            const before = e.clientY - rect.top < rect.height / 2;
            const insertIndex =
              [...leftContainer.querySelectorAll(".placed-letter")].indexOf(
                target
              ) + (before ? 0 : 1);
            available = available.filter((l) => l !== letter);
            placed.splice(insertIndex, 0, letter);
          } else {
            available = available.filter((l) => l !== letter);
            placed.push(letter);
          }
        } else if (dragSource === "left-container") {
          // re-order within placed
          const fromIdx = placed.indexOf(letter);
          if (fromIdx === -1) return;
          placed.splice(fromIdx, 1);
          if (target) {
            const rect = target.getBoundingClientRect();
            const before = e.clientY - rect.top < rect.height / 2;
            const toIdx =
              [...leftContainer.querySelectorAll(".placed-letter")].indexOf(
                target
              ) + (before ? 0 : 1);
            placed.splice(toIdx, 0, letter);
          } else {
            placed.push(letter);
          }
        }
        renderLeft();
        renderRight();
        updateKPI();
      });

      // Quick click interactions
      function moveToLeft(letter) {
        if (!available.includes(letter)) return;
        available = available.filter((l) => l !== letter);
        placed.push(letter);
        renderLeft();
        renderRight();
        updateKPI();
      }
      function removeFromLeft(letter, index) {
        placed.splice(index, 1);
        if (!available.includes(letter)) available.push(letter);
        renderLeft();
        renderRight();
        updateKPI();
      }

      // === Controls ===
      shuffleBtn.addEventListener("click", () => {
        available = randShuffle(available);
        renderRight();
        showToast("‡≤Ö‡≤ï‡≥ç‡≤∑‡≤∞‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤ø‡≤∂‡≥ç‡≤∞‡≤ø‡≤§‡≤µ‡≤æ‡≤¶‡≤µ‡≥Å");
      });
      hintBtn.addEventListener("click", () => {
        const box = document.getElementById("helpBox");
        box.open = !box.open;
      });

      checkBtn.addEventListener("click", () => {
        const correct = placed.filter((l, i) => l === KANNADA[i]).length;
        const score = Math.round((correct / KANNADA.length) * 100);
        scoreOut.textContent = score;
        showToast(`‡≤Ö‡≤Ç‡≤ï‡≤ó‡≤≥‡≥Å: ${score}%`);
        if (score === 100) celebrate();
      });

      resetBtn.addEventListener("click", () => {
        available = [...KANNADA];
        placed = [];
        renderLeft();
        renderRight();
        updateKPI();
        showToast("‡≤Ü‡≤ü ‡≤Æ‡≤∞‡≥Å‡≤∏‡≥ç‡≤•‡≤æ‡≤™‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü");
      });

      showCorrectBtn.addEventListener("click", () => {
        correctGrid.innerHTML = "";
        KANNADA.forEach((l) => {
          const s = document.createElement("div");
          s.className = "letter-pill";
          s.textContent = l;
          correctGrid.appendChild(s);
        });
        modal.classList.add("open");
      });
      closeModal.addEventListener("click", () =>
        modal.classList.remove("open")
      );
      modal.addEventListener("click", (e) => {
        if (e.target === modal) modal.classList.remove("open");
      });

      // === Confetti ===
      function celebrate() {
        for (let i = 0; i < 60; i++) {
          const c = document.createElement("div");
          c.className = "confetti";
          Object.assign(c.style, {
            position: "fixed",
            top: "-10px",
            left: Math.random() * 100 + "%",
            width: "10px",
            height: "10px",
            background: `hsl(${Math.random() * 360} 90% 60%)`,
            borderRadius: "2px",
            zIndex: 30,
            transform: `translateY(0) rotate(0)`,
          });
          document.body.appendChild(c);
          const y = window.innerHeight + 20;
          c.animate(
            [
              { transform: "translateY(0) rotate(0deg)", opacity: 1 },
              {
                transform: `translateY(${y}px) rotate(${
                  360 + Math.random() * 720
                }deg)`,
                opacity: 0,
              },
            ],
            { duration: 2600 + Math.random() * 1200, easing: "linear" }
          );
          setTimeout(() => c.remove(), 3800);
        }
      }

      // === Init ===
      (function init() {
        renderRight();
        renderLeft();
        updateKPI();
      })();
    </script>
  </body>
</html>
